COPY INTO @my_ext_stage/DATA_CLEANED_WITH_KPS
FROM (SELECT * FROM DATA_CLEANED_WITH_KPS)
FILE_FORMAT = (TYPE = 'CSV'); --Para exortar una tabla desde snowflake a gcp

select * from DSCOVR.SPACEAPPS.DATA_CLEANED_WITH_KPS limit 50;

SELECT * FROM DSCOVR.SPACEAPPS.COMPLETE_DATA_WITH_KP_CUADRADO LIMIT 5000;
DESCRIBE TABLE DSCOVR.SPACEAPPS.COMPLETE_DATA_WITH_KP_CUADRADO;

SELECT * FROM DSCOVR.SPACEAPPS.DATA_CLEANED_WITH_KPS;

-- CREATE OR REPLACE TABLE DSCOVR.SPACEAPPS.DATA_CLEANED_WITH_KPS_EXTENDED AS
WITH PRUEBA AS (
SELECT 
TIMESTAMP,
CASE 
    WHEN RIGHT(TIMESTAMP,8) BETWEEN '00:00:00' AND '02:59:59' THEN KP1
    WHEN RIGHT(TIMESTAMP,8) BETWEEN '03:00:00' AND '05:59:59' THEN KP2
    WHEN RIGHT(TIMESTAMP,8) BETWEEN '06:00:00' AND '08:59:59' THEN KP3
    WHEN RIGHT(TIMESTAMP,8) BETWEEN '09:00:00' AND '11:59:59' THEN KP4
    WHEN RIGHT(TIMESTAMP,8) BETWEEN '12:00:00' AND '14:59:59' THEN KP5
    WHEN RIGHT(TIMESTAMP,8) BETWEEN '15:00:00' AND '17:59:59' THEN KP6
    WHEN RIGHT(TIMESTAMP,8) BETWEEN '18:00:00' AND '20:59:59' THEN KP7
    WHEN RIGHT(TIMESTAMP,8) BETWEEN '21:00:00' AND '23:59:59' THEN KP8
END AS KP,
BSR,
DB,
AP,
SN,
F107OBS,
F107ADJ,
D,
gse_x,
gse_y,
gse_z,
CUADRADO AS GSE_MOD,
RAW_4,
RAW_5,
RAW_6,
RAW_7,
RAW_8,
RAW_9,
RAW_10,
RAW_11,
RAW_12,
RAW_13,
RAW_14,
RAW_15,
RAW_16,
RAW_17,
RAW_18,
RAW_19,
RAW_20,
RAW_21,
RAW_22,
RAW_23,
RAW_24,
RAW_25,
RAW_26,
RAW_27,
RAW_28,
RAW_29,
RAW_30,
RAW_31,
RAW_32,
RAW_33,
RAW_34,
RAW_35,
RAW_36,
RAW_37,
RAW_38,
RAW_39,
RAW_40,
RAW_41,
RAW_42,
RAW_43,
RAW_44,
RAW_45,
RAW_46,
RAW_47,
RAW_48,
RAW_49,
RAW_50,
RAW_51,
RAW_52,
RAW_53
FROM DSCOVR.SPACEAPPS.COMPLETE_DATA_WITH_KP_CUADRADO
)
SELECT * FROM PRUEBA;